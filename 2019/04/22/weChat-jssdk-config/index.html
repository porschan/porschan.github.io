<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="porschan,710437653@qq.com"><title>微信公众平台JS-SDK的config接口注入权限验证配置 · chanchifeng</title><meta name="description" content="今天，我将简单介绍一下如何通过java能完成微信公众平台JS-SDK的config接口注入权限验证配置。
主要使用的微信接口如下：123456781.通过appid和secret，获取token：https://api.weixin.qq.com/cgi-bin/token?grant_type=c"><meta name="keywords" content="Hexo,HTML,CSS,android,Linux"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title><a href="/">chanchifeng</a></h3><div class="description"><p>Carpet Diem</p></div></div></div><ul class="social-links"><li><a href="http://github.com/porschan"><i class="fa fa-github"></i></a></li></ul><div class="footer"></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li><li><a href="/readme">引导</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>微信公众平台JS-SDK的config接口注入权限验证配置</a></h3></div><div class="post-content"><p>今天，我将简单介绍一下如何通过java能完成微信公众平台JS-SDK的config接口注入权限验证配置。</p>
<h4 id="主要使用的微信接口如下："><a href="#主要使用的微信接口如下：" class="headerlink" title="主要使用的微信接口如下："></a>主要使用的微信接口如下：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1.通过appid和secret，获取token：</span><br><span class="line"></span><br><span class="line">https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=APPID&amp;secret=SECRET</span><br><span class="line"></span><br><span class="line">2.通过token，获取ticket:</span><br><span class="line"></span><br><span class="line">https://api.weixin.qq.com/cgi-bin/ticket/getticket?type=jsapi&amp;access_token=ACCESS_TOKEN</span><br></pre></td></tr></table></figure>
<h4 id="如何获取appid和secret？"><a href="#如何获取appid和secret？" class="headerlink" title="如何获取appid和secret？"></a>如何获取appid和secret？</h4><p>这里我们获取appid和secret并不是使用真正的微信公众号的appid和secret，而且使用<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login" target="_blank" rel="noopener">接口测试账号申请</a>的appid和secret,操作如下：</p>
<p><img src="/2019/04/22/weChat-jssdk-config/../weChat-jssdk-config/loginTest.gif" alt></p>
<p>登录完成之后，如下图所示：</p>
<p><img src="/2019/04/22/weChat-jssdk-config/../weChat-jssdk-config/20180712164313.png" alt></p>
<p>此时，可以在页面根据页面的测试号信息中获取appid和secret，到此，先让自己的测试的Demo页面能在外网访问。</p>
<p><a href="http://demo.open.weixin.qq.com/jssdk" target="_blank" rel="noopener">DEMO页面</a></p>
<p>可以先把地址用自己的手机访问，是否官方的页面是否正常，如果正常则可以把DEMO页面拿下来，并放到自己的项目中，并让外网能访问。</p>
<p>注意：我这里外网访问的路径是http:www.你的域名.com/你的项目名称/你的方法名称</p>
<p>ok，外网可以访问到自己把demo页面拿下来之后，分析页面会发现以下配置提醒，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * 注意：</span><br><span class="line"> * 1. 所有的JS接口只能在公众号绑定的域名下调用，公众号开发者需要先登录微信公众平台进入“公众号设置”的“功能设置”里填写“JS接口安全域名”。</span><br><span class="line"> * 2. 如果发现在 Android 不能分享自定义内容，请到官网下载最新的包覆盖安装，Android 自定义分享接口需升级至 6.0.2.58 版本及以上。</span><br><span class="line"> * 3. 常见问题及完整 JS-SDK 文档地址：http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html</span><br><span class="line"> *</span><br><span class="line"> * 开发中遇到问题详见文档“附录5-常见错误及解决办法”解决，如仍未能解决可通过以下渠道反馈：</span><br><span class="line"> * 邮箱地址：weixin-open@qq.com</span><br><span class="line"> * 邮件主题：【微信JS-SDK反馈】具体问题</span><br><span class="line"> * 邮件内容说明：用简明的语言描述问题所在，并交代清楚遇到该问题的场景，可附上截屏图片，微信团队会尽快处理你的反馈。</span><br><span class="line"> */</span><br><span class="line">wx.config(&#123;</span><br><span class="line">    debug: false,</span><br><span class="line">    appId: &apos;wxf8b4f85f3a794e77&apos;,</span><br><span class="line">    timestamp: 1531385535,</span><br><span class="line">    nonceStr: &apos;5qBjQwOM7dphJU1x&apos;,</span><br><span class="line">    signature: &apos;d2594f9b9a029709ca093051c9863535ae7f64a8&apos;,</span><br><span class="line">    jsApiList: [</span><br><span class="line">      &apos;checkJsApi&apos;,</span><br><span class="line">      &apos;onMenuShareTimeline&apos;,</span><br><span class="line">      &apos;onMenuShareAppMessage&apos;,</span><br><span class="line">      &apos;onMenuShareQQ&apos;,</span><br><span class="line">      &apos;onMenuShareWeibo&apos;,</span><br><span class="line">      &apos;onMenuShareQZone&apos;,</span><br><span class="line">      &apos;hideMenuItems&apos;,</span><br><span class="line">      &apos;showMenuItems&apos;,</span><br><span class="line">      &apos;hideAllNonBaseMenuItem&apos;,</span><br><span class="line">      &apos;showAllNonBaseMenuItem&apos;,</span><br><span class="line">      &apos;translateVoice&apos;,</span><br><span class="line">      &apos;startRecord&apos;,</span><br><span class="line">      &apos;stopRecord&apos;,</span><br><span class="line">      &apos;onVoiceRecordEnd&apos;,</span><br><span class="line">      &apos;playVoice&apos;,</span><br><span class="line">      &apos;onVoicePlayEnd&apos;,</span><br><span class="line">      &apos;pauseVoice&apos;,</span><br><span class="line">      &apos;stopVoice&apos;,</span><br><span class="line">      &apos;uploadVoice&apos;,</span><br><span class="line">      &apos;downloadVoice&apos;,</span><br><span class="line">      &apos;chooseImage&apos;,</span><br><span class="line">      &apos;previewImage&apos;,</span><br><span class="line">      &apos;uploadImage&apos;,</span><br><span class="line">      &apos;downloadImage&apos;,</span><br><span class="line">      &apos;getNetworkType&apos;,</span><br><span class="line">      &apos;openLocation&apos;,</span><br><span class="line">      &apos;getLocation&apos;,</span><br><span class="line">      &apos;hideOptionMenu&apos;,</span><br><span class="line">      &apos;showOptionMenu&apos;,</span><br><span class="line">      &apos;closeWindow&apos;,</span><br><span class="line">      &apos;scanQRCode&apos;,</span><br><span class="line">      &apos;chooseWXPay&apos;,</span><br><span class="line">      &apos;openProductSpecificView&apos;,</span><br><span class="line">      &apos;addCard&apos;,</span><br><span class="line">      &apos;chooseCard&apos;,</span><br><span class="line">      &apos;openCard&apos;</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="如何通过已有的appid和secret获取关键的appId（已用）、timestamp、nonceStr和signature，这里就需要使用上面的接口了，直接po代码。"><a href="#如何通过已有的appid和secret获取关键的appId（已用）、timestamp、nonceStr和signature，这里就需要使用上面的接口了，直接po代码。" class="headerlink" title="如何通过已有的appid和secret获取关键的appId（已用）、timestamp、nonceStr和signature，这里就需要使用上面的接口了，直接po代码。"></a>如何通过已有的appid和secret获取关键的appId（已用）、timestamp、nonceStr和signature，这里就需要使用上面的接口了，直接po代码。</h4><p>注意：我使用的框架是jfinal。</p>
<p>访问页面的controller:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 测试微信页面</span><br><span class="line"> * Test</span><br><span class="line"> */</span><br><span class="line">@ClearInterceptor(ClearLayer.ALL)</span><br><span class="line">@ActionKey(&quot;/wechatApi&quot;)</span><br><span class="line">public void wechatApi()&#123;</span><br><span class="line">    if (getStaff() != null)</span><br><span class="line">        removeSessionAttr(&quot;user&quot;);</span><br><span class="line"></span><br><span class="line">    WcConfigBean wcConfig = WechatKit.getWcConfig(getRequest().getRequestURI());</span><br><span class="line">    </span><br><span class="line">    setAttr(&quot;appId&quot;,wcConfig.getAppId());</span><br><span class="line">    setAttr(&quot;timestamp&quot;,wcConfig.getTimestamp());</span><br><span class="line">    setAttr(&quot;nonceStr&quot;,wcConfig.getNonceStr());</span><br><span class="line">    setAttr(&quot;signature&quot;,wcConfig.getSignature());</span><br><span class="line"></span><br><span class="line">    renderFreeMarker(&quot;../wechat/test/wechatApi.ftl&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>获取token和ticket的凭票及有效性的util:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package ligent.util.weChatKit;</span><br><span class="line"></span><br><span class="line">import org.json.JSONException;</span><br><span class="line">import org.json.JSONObject;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author:porschan</span><br><span class="line"> * @description:</span><br><span class="line"> * @date: Created in 17:04 2018/7/11</span><br><span class="line"> * @modified By:</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class Token &#123;</span><br><span class="line"></span><br><span class="line">    private static String access_token=&quot;&quot;;</span><br><span class="line"></span><br><span class="line">    private static String jsapi_ticket = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public static int time = 0;</span><br><span class="line"></span><br><span class="line">    private static int expires_in = 7200;</span><br><span class="line"></span><br><span class="line">    static&#123;</span><br><span class="line">        Thread t = new Thread(new Runnable()&#123;</span><br><span class="line">            public void run()&#123;</span><br><span class="line">                do&#123;</span><br><span class="line">                    time++;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        Thread.sleep(1000);</span><br><span class="line">                    &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;while(true);</span><br><span class="line">            &#125;&#125;);</span><br><span class="line">        t.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String getToken()&#123;</span><br><span class="line">        if(&quot;&quot;.equals(access_token)||access_token==null)&#123;</span><br><span class="line">            send();</span><br><span class="line">        &#125;else if(time&gt;expires_in)&#123;</span><br><span class="line">            //当前token已经失效，从新获取信息</span><br><span class="line">            send();</span><br><span class="line">        &#125;</span><br><span class="line">        return access_token;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static String getTicket()&#123;</span><br><span class="line">        if(&quot;&quot;.equals(jsapi_ticket)||jsapi_ticket==null)&#123;</span><br><span class="line">            send();</span><br><span class="line">        &#125;else if(time&gt;expires_in)&#123;</span><br><span class="line">            //当前token已经失效，从新获取信息</span><br><span class="line">            send();</span><br><span class="line">        &#125;</span><br><span class="line">        return jsapi_ticket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void send()&#123;</span><br><span class="line">        String url = WXConfig.server_token_url.replace(&quot;APPID&quot;,WXConfig.appid).replace(&quot;SECRET&quot;,WXConfig.appsecret);</span><br><span class="line">        JSONObject json = SendHttpRequest.sendGet(url);</span><br><span class="line">//        access_token = json.getString(&quot;access_token&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line">            access_token = json.getString(&quot;access_token&quot;);</span><br><span class="line">        &#125; catch (JSONException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        String ticket_url = WXConfig.access_token_url.replace(&quot;ACCESS_TOKEN&quot;,access_token);</span><br><span class="line">        try &#123;</span><br><span class="line">            jsapi_ticket = SendHttpRequest.sendGet(ticket_url).getString(&quot;ticket&quot;);</span><br><span class="line">        &#125; catch (JSONException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        time = 0;</span><br><span class="line">//        if(!&quot;&quot;.equals(access_token)&amp;&amp;!&quot;&quot;.equals(jsapi_ticket))&#123;</span><br><span class="line">//            new Thread</span><br><span class="line">//        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>微信官方提供的加密签名的util,<a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115" target="_blank" rel="noopener">下载页面</a>及<a href="http://demo.open.weixin.qq.com/jssdk/sample.zip" target="_blank" rel="noopener">下载链接</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package ligent.util.weChatKit;</span><br><span class="line"></span><br><span class="line">import java.io.UnsupportedEncodingException;</span><br><span class="line">import java.security.MessageDigest;</span><br><span class="line">import java.security.NoSuchAlgorithmException;</span><br><span class="line">import java.util.Formatter;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.UUID;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author:porschan</span><br><span class="line"> * @description:</span><br><span class="line"> *</span><br><span class="line"> * 来自官方文档的加密方式</span><br><span class="line"> *</span><br><span class="line"> * JAVA, Node, Python 部分代码只实现了签名算法，需要开发者传入 jsapi_ticket 和 url ，</span><br><span class="line"> * 其中 jsapi_ticket 需要通过 http://api.weixin.qq.com/cgi-bin/ticket/getticket?type=jsapi&amp;access_token=ACCESS_TOKEN 接口获取</span><br><span class="line"> * ，url 为调用页面的完整 url 。</span><br><span class="line"> *</span><br><span class="line"> * PHP 部分代码包括了获取 access_token 和 jsapi_ticket 的操作，只需传入 appid 和 appsecret 即可，</span><br><span class="line"> * 但要注意如果已有其他业务需要使用 access_token 的话，应修改获取 access_token 部分代码从全局缓存中获取，</span><br><span class="line"> * 防止重复获取 access_token ，超过调用频率。</span><br><span class="line"> *</span><br><span class="line"> * 注意事项：</span><br><span class="line"> * 1. jsapi_ticket 的有效期为 7200 秒，开发者必须全局缓存 jsapi_ticket ，防止超过调用频率。</span><br><span class="line"> *</span><br><span class="line"> * @date: Created in 16:29 2018/7/11</span><br><span class="line"> * @modified By:</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class sign &#123;</span><br><span class="line"></span><br><span class="line">    //额外添加</span><br><span class="line">    public static WcConfigBean getWcConfigBean(String jsapi_ticket, String url,String appId)&#123;</span><br><span class="line">        Map&lt;String, String&gt; ret = sign(jsapi_ticket, url);</span><br><span class="line"></span><br><span class="line">        WcConfigBean wcConfigBean = new WcConfigBean();</span><br><span class="line"></span><br><span class="line">        wcConfigBean.setAppId(appId);</span><br><span class="line"></span><br><span class="line">        for (Map.Entry entry : ret.entrySet()) &#123;</span><br><span class="line">            switch(entry.getKey().toString())&#123;</span><br><span class="line">                case &quot;url&quot; :</span><br><span class="line">                    wcConfigBean.setUrl(String.valueOf(entry.getValue()));</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;nonceStr&quot; :</span><br><span class="line">                    wcConfigBean.setNonceStr(String.valueOf(entry.getValue()));</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;timestamp&quot; :</span><br><span class="line">                    wcConfigBean.setTimestamp(String.valueOf(entry.getValue()));</span><br><span class="line">                    break;</span><br><span class="line">                case &quot;signature&quot; :</span><br><span class="line">                    wcConfigBean.setSignature(String.valueOf(entry.getValue()));</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return wcConfigBean;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        String jsapi_ticket = &quot;HoagFKDcsGMVCIY2vOjf9vekSs_wMj2R9WS9DiM被你发现了,保密数据83KNuhk8dQ&quot;;</span><br><span class="line"></span><br><span class="line">        // 注意 URL 一定要动态获取，不能 hardcode</span><br><span class="line">        String url = &quot;http://www.你的域名.com/项目名称/访问的方法&quot;;</span><br><span class="line">        Map&lt;String, String&gt; ret = sign(jsapi_ticket, url);</span><br><span class="line">        for (Map.Entry entry : ret.entrySet()) &#123;</span><br><span class="line">            System.out.println(entry.getKey() + &quot;, &quot; + entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //获取签名</span><br><span class="line">    public static Map&lt;String, String&gt; sign(String jsapi_ticket, String url) &#123;</span><br><span class="line">        Map&lt;String, String&gt; ret = new HashMap&lt;String, String&gt;();</span><br><span class="line">        String nonce_str = create_nonce_str();</span><br><span class="line">        String timestamp = create_timestamp();</span><br><span class="line">        String string1;</span><br><span class="line">        String signature = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">        //注意这里参数名必须全部小写，且必须有序</span><br><span class="line">        string1 = &quot;jsapi_ticket=&quot; + jsapi_ticket +</span><br><span class="line">                &quot;&amp;noncestr=&quot; + nonce_str +</span><br><span class="line">                &quot;&amp;timestamp=&quot; + timestamp +</span><br><span class="line">                &quot;&amp;url=&quot; + url;</span><br><span class="line">        System.out.println(string1);</span><br><span class="line"></span><br><span class="line">        try</span><br><span class="line">        &#123;</span><br><span class="line">            MessageDigest crypt = MessageDigest.getInstance(&quot;SHA-1&quot;);</span><br><span class="line">            crypt.reset();</span><br><span class="line">            crypt.update(string1.getBytes(&quot;UTF-8&quot;));</span><br><span class="line">            signature = byteToHex(crypt.digest());</span><br><span class="line">        &#125;</span><br><span class="line">        catch (NoSuchAlgorithmException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        catch (UnsupportedEncodingException e)</span><br><span class="line">        &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ret.put(&quot;url&quot;, url);</span><br><span class="line">        ret.put(&quot;jsapi_ticket&quot;, jsapi_ticket);</span><br><span class="line">        ret.put(&quot;nonceStr&quot;, nonce_str);</span><br><span class="line">        ret.put(&quot;timestamp&quot;, timestamp);</span><br><span class="line">        ret.put(&quot;signature&quot;, signature);</span><br><span class="line"></span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String byteToHex(final byte[] hash) &#123;</span><br><span class="line">        Formatter formatter = new Formatter();</span><br><span class="line">        for (byte b : hash)</span><br><span class="line">        &#123;</span><br><span class="line">            formatter.format(&quot;%02x&quot;, b);</span><br><span class="line">        &#125;</span><br><span class="line">        String result = formatter.toString();</span><br><span class="line">        formatter.close();</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String create_nonce_str() &#123;</span><br><span class="line">        return UUID.randomUUID().toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static String create_timestamp() &#123;</span><br><span class="line">        return Long.toString(System.currentTimeMillis() / 1000);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有关微信配置的bean:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package ligent.util.weChatKit;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author:porschan</span><br><span class="line"> * @description:</span><br><span class="line"> * @date: Created in 10:29 2018/7/12</span><br><span class="line"> * @modified By:</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class WcConfigBean &#123;</span><br><span class="line"></span><br><span class="line">    String appId;//必填,公众号的唯一标识</span><br><span class="line"></span><br><span class="line">    String timestamp;//必填,生成签名的时间戳</span><br><span class="line"></span><br><span class="line">    String nonceStr;//必填,生成签名的随机串</span><br><span class="line"></span><br><span class="line">    String signature;//必填,签名</span><br><span class="line"></span><br><span class="line">    String url;//选填,访问页面的路径</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;WcConfigBean&#123;&quot; +</span><br><span class="line">                &quot;appId=&apos;&quot; + appId + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, timestamp=&apos;&quot; + timestamp + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, nonceStr=&apos;&quot; + nonceStr + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, signature=&apos;&quot; + signature + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, url=&apos;&quot; + url + &apos;\&apos;&apos; +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getAppId() &#123;</span><br><span class="line">        return appId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAppId(String appId) &#123;</span><br><span class="line">        this.appId = appId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getTimestamp() &#123;</span><br><span class="line">        return timestamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setTimestamp(String timestamp) &#123;</span><br><span class="line">        this.timestamp = timestamp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getNonceStr() &#123;</span><br><span class="line">        return nonceStr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setNonceStr(String nonceStr) &#123;</span><br><span class="line">        this.nonceStr = nonceStr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getSignature() &#123;</span><br><span class="line">        return signature;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setSignature(String signature) &#123;</span><br><span class="line">        this.signature = signature;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getUrl() &#123;</span><br><span class="line">        return url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setUrl(String url) &#123;</span><br><span class="line">        this.url = url;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>http请求的util:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package ligent.util.weChatKit;</span><br><span class="line"></span><br><span class="line">import org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line">import org.apache.http.client.methods.HttpGet;</span><br><span class="line">import org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line">import org.apache.http.impl.client.HttpClients;</span><br><span class="line">import org.apache.http.util.EntityUtils;</span><br><span class="line">import org.json.JSONObject;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author:porschan</span><br><span class="line"> * @description:</span><br><span class="line"> * @date: Created in 17:05 2018/7/11</span><br><span class="line"> * @modified By:</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class SendHttpRequest &#123;</span><br><span class="line"></span><br><span class="line">    public static JSONObject sendGet(String url)&#123;</span><br><span class="line"></span><br><span class="line">        CloseableHttpClient httpclient = HttpClients.createDefault();</span><br><span class="line">        JSONObject jsonResult = null;</span><br><span class="line">        HttpGet method = new HttpGet(url);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            CloseableHttpResponse result = httpclient.execute(method);</span><br><span class="line">            if (result.getStatusLine().getStatusCode() == 200) &#123;</span><br><span class="line">                String str = &quot;&quot;;</span><br><span class="line">                try &#123;</span><br><span class="line">                    str = EntityUtils.toString(result.getEntity());</span><br><span class="line">                    jsonResult = new JSONObject(str);</span><br><span class="line">                &#125; catch (Exception e) &#123;</span><br><span class="line">                    System.out.println(&quot;get请求提交失败:&quot; + url);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            System.out.println(&quot;get请求提交失败:&quot; + url);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return jsonResult;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>微信页面可能用到参数的util:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package ligent.util.weChatKit;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author:porschan</span><br><span class="line"> * @description:</span><br><span class="line"> * @date: Created in 10:21 2018/7/12</span><br><span class="line"> * @modified By:</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class WechatKit &#123;</span><br><span class="line"></span><br><span class="line">    //获取access_token</span><br><span class="line">    public static String getAccessToken()&#123;</span><br><span class="line">        return  Token.getToken();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //获取ticket</span><br><span class="line">    public static String getTicket()&#123;</span><br><span class="line">        return Token.getTicket();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //获取页面的api信息</span><br><span class="line">    public static WcConfigBean getWcConfig(String requestURI)&#123;</span><br><span class="line">        String jsapi_ticket = getTicket();</span><br><span class="line">        return sign.getWcConfigBean(jsapi_ticket,WXConfig.redirect_uri + requestURI,WXConfig.appid);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试WechatKit的方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package ligent.test.weChatKitTest;</span><br><span class="line"></span><br><span class="line">import ligent.util.weChatKit.WechatKit;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author:porschan</span><br><span class="line"> * @description:</span><br><span class="line"> *</span><br><span class="line"> * 测试WeChatKit的类</span><br><span class="line"> *</span><br><span class="line"> * @date: Created in 15:24 2018/7/12</span><br><span class="line"> * @modified By:</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class WeChatKitTest &#123;</span><br><span class="line"></span><br><span class="line">//    @Test</span><br><span class="line">    public void weChatKitTest1()&#123;</span><br><span class="line">        System.out.println(&quot;accessToken&quot; + WechatKit.getAccessToken());</span><br><span class="line">        System.out.println(&quot;ticket:&quot; + WechatKit.getTicket());</span><br><span class="line">        System.out.println(WechatKit.getWcConfig(&quot;/etcc/wechatApi&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        new WeChatKitTest().weChatKitTest1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#-----------------------------------------------------------</span><br><span class="line"># 微信公众号设置</span><br><span class="line">#-----------------------------------------------------------</span><br><span class="line">weChat.appid=你的APPID,e.g.:从接口测试账号申请的获取的appid</span><br><span class="line">weChat.appsecret=你的APPSECRET,e.g.:从接口测试账号申请的获取的appsecret</span><br><span class="line">weChat.redirect_uri=外网访问的页面，e.g.:http://www.baidu.com</span><br></pre></td></tr></table></figure>
<p>完成之后，使用时手机访问的你的项目中的demo页面，如图所示，则成功调用。</p>
<p><img src="/2019/04/22/weChat-jssdk-config/../weChat-jssdk-config/20180712171217.jpg" alt></p>
<p>以下就是使用调用api返回的结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">获取token的请求：</span><br><span class="line"></span><br><span class="line">https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid=你的APPID&amp;secret=你的SECRET</span><br><span class="line"></span><br><span class="line">获取token的响应：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;access_token&quot;: &quot;11_DXAnrOx-UnocqkswgEKsJT8BrmGFSO5uy-l0M9870YFG被你发现了,保密数据YGxt17gEN07pcHO8mmSyopQq-mbWFSknt2HkC9BHMcADANTY&quot;,</span><br><span class="line">    &quot;expires_in&quot;: 7200</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">获取ticket的请求：</span><br><span class="line"></span><br><span class="line">https://api.weixin.qq.com/cgi-bin/ticket/getticket?type=jsapi&amp;access_token=11_DXAnrOx-UnocqkswgEKsJT8BrmGFSO5uy-l0M987被你发现了,保密数据jH3nWAvFktuv2C6BvYGxt18mmSyopQq-mbWFSkANTY</span><br><span class="line"></span><br><span class="line">获取ticket的响应：</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    &quot;errcode&quot;: 0,</span><br><span class="line">    &quot;errmsg&quot;: &quot;ok&quot;,</span><br><span class="line">    &quot;ticket&quot;: &quot;HoagFKDcsGMVCIY2被你发现了,保密数据qyBXkZ4cMH_IwNYTwvr83KNuhk8dQ&quot;,</span><br><span class="line">    &quot;expires_in&quot;: 7200,</span><br><span class="line">	    &quot;asd&quot;:&#123;</span><br><span class="line">	    &quot;errcode&quot;: 0,</span><br><span class="line">	    &quot;errmsg&quot;: &quot;ok&quot;,</span><br><span class="line">	    &quot;ticket&quot;: &quot;HoagFKDcsGMV被你发现了,保密数据cMH_IwNYTwvr83KNuhk8dQ&quot;,</span><br><span class="line">	    &quot;expires_in&quot;: 7200</span><br><span class="line">	&#125;</span><br><span class="line">&#125;	</span><br><span class="line"></span><br><span class="line">使用官方的sign的签名打印：</span><br><span class="line"></span><br><span class="line">jsapi_ticket=HoagFKDcsGMVCIY2vOjf9vekS被你发现了,保密数据Z4cMH_IwNYTwvr83KNuhk8dQ&amp;noncestr=b7016842-2df1-4314-a617-a75245b281ea&amp;timestamp=1531299156&amp;url=http://www.你的域名.com/</span><br><span class="line">signature, cb97被你发现了,保密数据eadeeb81c038ce745b4ad5e265c</span><br><span class="line">jsapi_ticket, HoagFKDcsGMVCIY被你发现了,保密数据WjK46Wbek_a8jsNpqyBXkZ4cMH_IwNYTwvr83KNuhk8dQ</span><br><span class="line">url, http://www.你的域名.com/你的项目名称/你访问的方法</span><br><span class="line">nonceStr, b7016842-被你发现了,保密数据-a617-a75245b281ea</span><br><span class="line">timestamp, 1531299156</span><br></pre></td></tr></table></figure>
<p>感谢<a href="https://www.cnblogs.com/di8hao/p/5412708.html" target="_blank" rel="noopener">微信公众号网页开发-jssdk config配置参数生成（Java版）</a>博客中获取重要的代码部分。</p>
<p>PS:<br><a href="https://mp.weixin.qq.com/debug/" target="_blank" rel="noopener">微信公众平台接口调试工具</a><br><a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419318183&amp;token=&amp;lang=zh_CN" target="_blank" rel="noopener">公众号的接入指南</a></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-04-22</span><i class="fa fa-tag"></i></div></div></div></div><div class="cc"><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a></div><div class="cc_tips">本作品采用<a href="http://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a>进行许可。</div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/04/22/windows-bat/" title="Windows 下的一个有用的bat程序">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2019/04/22/ubuntu-flash/" title="Ubuntu系统打开flash插件和关闭自动锁屏">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>